# LuCI App Easy MWAN3 v2.0 Ultra

> "既要简单，又要强大？满足你。"

## 简介
这是 `easy_mwan3` 的完全进化版。在保持“一键配置”的基础上，引入了企业级 CPE 才有的策略路由功能。
现在，你可以精确控制每一台设备、每一个目标的流量走向，同时依然不需要碰那些复杂的 MWAN3 原始配置。

## 新增特性 (v2.0 Ultra)
- **📱 设备分流 (Source Policy)**:
  - 指定特定设备（如电视、游戏机）强制走特定接口（如 WAN2）。
  - 支持 MAC 地址绑定，设备 IP 变了也不怕。
- **🎯 目标分流 (Destination Policy)**:
  - 访问特定 IP 段（如公司内网、特定游戏服务器）时强制走特定接口。
- **🧲 智能粘滞 (Smart Sticky)**:
  - **HTTPS 粘滞**: 防止网银掉线。
  - **源地址粘滞**: 激进模式，确保同一设备长时间不跳变出口 IP。
- **⚖️ 混合模式**:
  - 全局可以设定为“负载均衡”或“故障转移”，个别设备可以单独设定例外规则。

## 核心逻辑优先级
插件生成的规则优先级如下（从高到低）：
1. **目标分流规则**: "我要去哪里？" -> 强制接口。
2. **设备分流规则**: "我是谁？" -> 强制接口。
3. **粘滞规则**: "我刚才走的哪条路？" -> 保持原路。
4. **默认策略**: 听天由命（负载均衡）或 听大哥的（主备切换）。

## 使用指南
1. **启用插件**: 在“全局设置”中勾选启用。
2. **添加接口**: 在“物理接口定义”中添加你的 WAN 口。
3. **添加例外**: 如果有设备需要特殊照顾，在“设备分流策略”里添加它。
4. **保存应用**: 脚本会在后台自动重写 MWAN3 配置并重启服务。

## 目录结构
```text
luci-app-easy-mwan3/
├── Makefile                # v2.0 Ultra
├── root/
│   ├── etc/config/         # 扩展后的配置文件
│   └── usr/bin/            # 核心生成脚本 (v2.0 Ultra)
└── luasrc/                 # 包含新 Tab 的 Web 界面
```

---
*Generated by Antigravity (Cyber Elf)*